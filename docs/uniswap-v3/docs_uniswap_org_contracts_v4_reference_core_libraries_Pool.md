[Skip to main content](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#)

On this page

# Pool

[Git Source](https://github.com/uniswap/v4-core/blob/b619b6718e31aa5b4fa0286520c455ceb950276d/src/libraries/Pool.sol) \- Generated with [forge doc](https://book.getfoundry.sh/reference/forge/forge-doc)

a library with all actions that can be performed on a pool

## Functions [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#functions "Direct link to heading")

### checkTicks [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#checkticks "Direct link to heading")

_Common checks for valid tick inputs._

```codeBlockLines_mRuA
function checkTicks(int24 tickLower, int24 tickUpper) private pure;

```

Copy

### initialize [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#initialize "Direct link to heading")

```codeBlockLines_mRuA
function initialize(State storage self, uint160 sqrtPriceX96, uint24 lpFee) internal returns (int24 tick);

```

Copy

### setProtocolFee [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#setprotocolfee "Direct link to heading")

```codeBlockLines_mRuA
function setProtocolFee(State storage self, uint24 protocolFee) internal;

```

Copy

### setLPFee [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#setlpfee "Direct link to heading")

Only dynamic fee pools may update the lp fee.

```codeBlockLines_mRuA
function setLPFee(State storage self, uint24 lpFee) internal;

```

Copy

### modifyLiquidity [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#modifyliquidity "Direct link to heading")

Effect changes to a position in a pool

_PoolManager checks that the pool is initialized before calling_

```codeBlockLines_mRuA
function modifyLiquidity(State storage self, ModifyLiquidityParams memory params)
    internal
    returns (BalanceDelta delta, BalanceDelta feeDelta);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `self` | `State` |  |
| `params` | `ModifyLiquidityParams` | the position details and the change to the position's liquidity to effect |

**Returns**

| Name | Type | Description |
| --- | --- | --- |
| `delta` | `BalanceDelta` | the deltas of the token balances of the pool, from the liquidity change |
| `feeDelta` | `BalanceDelta` | the fees generated by the liquidity range |

### swap [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#swap "Direct link to heading")

Executes a swap against the state, and returns the amount deltas of the pool

_PoolManager checks that the pool is initialized before calling_

```codeBlockLines_mRuA
function swap(State storage self, SwapParams memory params)
    internal
    returns (BalanceDelta swapDelta, uint256 amountToProtocol, uint24 swapFee, SwapResult memory result);

```

Copy

### donate [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#donate "Direct link to heading")

Donates the given amount of currency0 and currency1 to the pool

```codeBlockLines_mRuA
function donate(State storage state, uint256 amount0, uint256 amount1) internal returns (BalanceDelta delta);

```

Copy

### getFeeGrowthInside [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#getfeegrowthinside "Direct link to heading")

Retrieves fee growth data

```codeBlockLines_mRuA
function getFeeGrowthInside(State storage self, int24 tickLower, int24 tickUpper)
    internal
    view
    returns (uint256 feeGrowthInside0X128, uint256 feeGrowthInside1X128);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `self` | `State` | The Pool state struct |
| `tickLower` | `int24` | The lower tick boundary of the position |
| `tickUpper` | `int24` | The upper tick boundary of the position |

**Returns**

| Name | Type | Description |
| --- | --- | --- |
| `feeGrowthInside0X128` | `uint256` | The all-time fee growth in token0, per unit of liquidity, inside the position's tick boundaries |
| `feeGrowthInside1X128` | `uint256` | The all-time fee growth in token1, per unit of liquidity, inside the position's tick boundaries |

### updateTick [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#updatetick "Direct link to heading")

Updates a tick and returns true if the tick was flipped from initialized to uninitialized, or vice versa

```codeBlockLines_mRuA
function updateTick(State storage self, int24 tick, int128 liquidityDelta, bool upper)
    internal
    returns (bool flipped, uint128 liquidityGrossAfter);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `self` | `State` | The mapping containing all tick information for initialized ticks |
| `tick` | `int24` | The tick that will be updated |
| `liquidityDelta` | `int128` | A new amount of liquidity to be added (subtracted) when tick is crossed from left to right (right to left) |
| `upper` | `bool` | true for updating a position's upper tick, or false for updating a position's lower tick |

**Returns**

| Name | Type | Description |
| --- | --- | --- |
| `flipped` | `bool` | Whether the tick was flipped from initialized to uninitialized, or vice versa |
| `liquidityGrossAfter` | `uint128` | The total amount of liquidity for all positions that references the tick after the update |

### tickSpacingToMaxLiquidityPerTick [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#tickspacingtomaxliquiditypertick "Direct link to heading")

Derives max liquidity per tick from given tick spacing

_Executed when adding liquidity_

```codeBlockLines_mRuA
function tickSpacingToMaxLiquidityPerTick(int24 tickSpacing) internal pure returns (uint128 result);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `tickSpacing` | `int24` | The amount of required tick separation, realized in multiples of `tickSpacing` e.g., a tickSpacing of 3 requires ticks to be initialized every 3rd tick i.e., ..., -6, -3, 0, 3, 6, ... |

**Returns**

| Name | Type | Description |
| --- | --- | --- |
| `result` | `uint128` | The max liquidity per tick |

### checkPoolInitialized [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#checkpoolinitialized "Direct link to heading")

Reverts if the given pool has not been initialized

```codeBlockLines_mRuA
function checkPoolInitialized(State storage self) internal view;

```

Copy

### clearTick [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#cleartick "Direct link to heading")

Clears tick data

```codeBlockLines_mRuA
function clearTick(State storage self, int24 tick) internal;

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `self` | `State` | The mapping containing all initialized tick information for initialized ticks |
| `tick` | `int24` | The tick that will be cleared |

### crossTick [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#crosstick "Direct link to heading")

Transitions to next tick as needed by price movement

```codeBlockLines_mRuA
function crossTick(State storage self, int24 tick, uint256 feeGrowthGlobal0X128, uint256 feeGrowthGlobal1X128)
    internal
    returns (int128 liquidityNet);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `self` | `State` | The Pool state struct |
| `tick` | `int24` | The destination tick of the transition |
| `feeGrowthGlobal0X128` | `uint256` | The all-time global fee growth, per unit of liquidity, in token0 |
| `feeGrowthGlobal1X128` | `uint256` | The all-time global fee growth, per unit of liquidity, in token1 |

**Returns**

| Name | Type | Description |
| --- | --- | --- |
| `liquidityNet` | `int128` | The amount of liquidity added (subtracted) when tick is crossed from left to right (right to left) |

## Errors [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#errors "Direct link to heading")

### TicksMisordered [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#ticksmisordered "Direct link to heading")

Thrown when tickLower is not below tickUpper

```codeBlockLines_mRuA
error TicksMisordered(int24 tickLower, int24 tickUpper);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `tickLower` | `int24` | The invalid tickLower |
| `tickUpper` | `int24` | The invalid tickUpper |

### TickLowerOutOfBounds [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#tickloweroutofbounds "Direct link to heading")

Thrown when tickLower is less than min tick

```codeBlockLines_mRuA
error TickLowerOutOfBounds(int24 tickLower);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `tickLower` | `int24` | The invalid tickLower |

### TickUpperOutOfBounds [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#tickupperoutofbounds "Direct link to heading")

Thrown when tickUpper exceeds max tick

```codeBlockLines_mRuA
error TickUpperOutOfBounds(int24 tickUpper);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `tickUpper` | `int24` | The invalid tickUpper |

### TickLiquidityOverflow [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#tickliquidityoverflow "Direct link to heading")

For the tick spacing, the tick has too much liquidity

```codeBlockLines_mRuA
error TickLiquidityOverflow(int24 tick);

```

Copy

### PoolAlreadyInitialized [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#poolalreadyinitialized "Direct link to heading")

Thrown when trying to initialize an already initialized pool

```codeBlockLines_mRuA
error PoolAlreadyInitialized();

```

Copy

### PoolNotInitialized [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#poolnotinitialized "Direct link to heading")

Thrown when trying to interact with a non-initialized pool

```codeBlockLines_mRuA
error PoolNotInitialized();

```

Copy

### PriceLimitAlreadyExceeded [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#pricelimitalreadyexceeded "Direct link to heading")

Thrown when sqrtPriceLimitX96 on a swap has already exceeded its limit

```codeBlockLines_mRuA
error PriceLimitAlreadyExceeded(uint160 sqrtPriceCurrentX96, uint160 sqrtPriceLimitX96);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `sqrtPriceCurrentX96` | `uint160` | The invalid, already surpassed sqrtPriceLimitX96 |
| `sqrtPriceLimitX96` | `uint160` | The surpassed price limit |

### PriceLimitOutOfBounds [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#pricelimitoutofbounds "Direct link to heading")

Thrown when sqrtPriceLimitX96 lies outside of valid tick/price range

```codeBlockLines_mRuA
error PriceLimitOutOfBounds(uint160 sqrtPriceLimitX96);

```

Copy

**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| `sqrtPriceLimitX96` | `uint160` | The invalid, out-of-bounds sqrtPriceLimitX96 |

### NoLiquidityToReceiveFees [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#noliquiditytoreceivefees "Direct link to heading")

Thrown by donate if there is currently 0 liquidity, since the fees will not go to any liquidity providers

```codeBlockLines_mRuA
error NoLiquidityToReceiveFees();

```

Copy

### InvalidFeeForExactOut [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#invalidfeeforexactout "Direct link to heading")

Thrown when trying to swap with max lp fee and specifying an output amount

```codeBlockLines_mRuA
error InvalidFeeForExactOut();

```

Copy

## Structs [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#structs "Direct link to heading")

### TickInfo [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#tickinfo "Direct link to heading")

```codeBlockLines_mRuA
struct TickInfo {
    uint128 liquidityGross;
    int128 liquidityNet;
    uint256 feeGrowthOutside0X128;
    uint256 feeGrowthOutside1X128;
}

```

Copy

### State [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#state "Direct link to heading")

_The state of a pool_

```codeBlockLines_mRuA
struct State {
    Slot0 slot0;
    uint256 feeGrowthGlobal0X128;
    uint256 feeGrowthGlobal1X128;
    uint128 liquidity;
    mapping(int24 tick => TickInfo) ticks;
    mapping(int16 wordPos => uint256) tickBitmap;
    mapping(bytes32 positionKey => Position.State) positions;
}

```

Copy

### ModifyLiquidityParams [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#modifyliquidityparams "Direct link to heading")

```codeBlockLines_mRuA
struct ModifyLiquidityParams {
    address owner;
    int24 tickLower;
    int24 tickUpper;
    int128 liquidityDelta;
    int24 tickSpacing;
    bytes32 salt;
}

```

Copy

### ModifyLiquidityState [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#modifyliquiditystate "Direct link to heading")

```codeBlockLines_mRuA
struct ModifyLiquidityState {
    bool flippedLower;
    uint128 liquidityGrossAfterLower;
    bool flippedUpper;
    uint128 liquidityGrossAfterUpper;
}

```

Copy

### SwapResult [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#swapresult "Direct link to heading")

```codeBlockLines_mRuA
struct SwapResult {
    uint160 sqrtPriceX96;
    int24 tick;
    uint128 liquidity;
}

```

Copy

### StepComputations [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#stepcomputations "Direct link to heading")

```codeBlockLines_mRuA
struct StepComputations {
    uint160 sqrtPriceStartX96;
    int24 tickNext;
    bool initialized;
    uint160 sqrtPriceNextX96;
    uint256 amountIn;
    uint256 amountOut;
    uint256 feeAmount;
    uint256 feeGrowthGlobalX128;
}

```

Copy

### SwapParams [​](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool\#swapparams "Direct link to heading")

```codeBlockLines_mRuA
struct SwapParams {
    int256 amountSpecified;
    int24 tickSpacing;
    bool zeroForOne;
    uint160 sqrtPriceLimitX96;
    uint24 lpFeeOverride;
}

```

Copy

- [Functions](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#functions)
  - [checkTicks](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#checkticks)
  - [initialize](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#initialize)
  - [setProtocolFee](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#setprotocolfee)
  - [setLPFee](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#setlpfee)
  - [modifyLiquidity](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#modifyliquidity)
  - [swap](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#swap)
  - [donate](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#donate)
  - [getFeeGrowthInside](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#getfeegrowthinside)
  - [updateTick](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#updatetick)
  - [tickSpacingToMaxLiquidityPerTick](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#tickspacingtomaxliquiditypertick)
  - [checkPoolInitialized](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#checkpoolinitialized)
  - [clearTick](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#cleartick)
  - [crossTick](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#crosstick)
- [Errors](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#errors)
  - [TicksMisordered](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#ticksmisordered)
  - [TickLowerOutOfBounds](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#tickloweroutofbounds)
  - [TickUpperOutOfBounds](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#tickupperoutofbounds)
  - [TickLiquidityOverflow](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#tickliquidityoverflow)
  - [PoolAlreadyInitialized](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#poolalreadyinitialized)
  - [PoolNotInitialized](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#poolnotinitialized)
  - [PriceLimitAlreadyExceeded](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#pricelimitalreadyexceeded)
  - [PriceLimitOutOfBounds](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#pricelimitoutofbounds)
  - [NoLiquidityToReceiveFees](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#noliquiditytoreceivefees)
  - [InvalidFeeForExactOut](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#invalidfeeforexactout)
- [Structs](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#structs)
  - [TickInfo](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#tickinfo)
  - [State](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#state)
  - [ModifyLiquidityParams](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#modifyliquidityparams)
  - [ModifyLiquidityState](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#modifyliquiditystate)
  - [SwapResult](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#swapresult)
  - [StepComputations](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#stepcomputations)
  - [SwapParams](https://docs.uniswap.org/contracts/v4/reference/core/libraries/Pool#swapparams)